{% extends 'layout.html' %}

{% block extra_head %}
    {% if session.user and session.user.is_admin %}
    {% else %}
        <script src="/static/js/jquery-3.7.0.min.js"></script>
        <script src="/static/js/jquery-confirm.min.js"></script>
        <script>
          jconfirm.defaults = {
            theme: 'modern',
            draggable: false,
            boxWidth: '30%',
            useBootstrap: false,
            escapeKey: true,
            backgroundDismiss: true,
          }
        </script>
    {% endif %}
{% endblock %}

{% block content %}

    <hgroup>
        <h2>Personvernserklæring</h2>
        <h3>Informasjon du trenger om hvilken data vi samler om deg</h3>
    </hgroup>

    <blockquote>
        <hgroup>
            <h4>Feide</h4>
            <h5>Når du logger inn med Feide, gir du fra deg følgende data</h5>
        </hgroup>
        Følgende data lagres:
        <ul>
            <li>Navn</li>
            <li>Student e-post</li>
            <li>Feide ID (En unik ID som representerer deg)</li>
        </ul>

        Følgende data gir du tilgang på, men brukes kun til autentisering:
        <ul>
            <li>Organisasjon (Gir oss informasjon om du er en gyldig elev eller ansatt)</li>
        </ul>
    </blockquote>

    <blockquote>
        <hgroup>
            <h4>Loggføring</h4>
            <h5>Når du låner utstyr, vil dette loggføres med navnet ditt</h5>
        </hgroup>

        For å kunne identifisere hvem som har brukt utstyret, arkiveres & loggføres følgende data i det du låner utstyr:
        <ul>
            <li>Navn på utlåner</li>
            <li>Klasse og kontaktlærer</li>
            <li>Dato og tidspunkt</li>
            <li>Hvilket utstyr som er brukt</li>
        </ul>

        Dette er for å kunne identifisere hvem som har brukt utstyret over tid, og for å kunne spore utstyr som ikke
        blir levert.
    </blockquote>

    <blockquote>
        <hgroup>
            <h4>Ved registrering</h4>
            <h5>Når du registrerer deg, lagres følgende data</h5>
        </hgroup>
        <ul>
            <li>Ditt valg om klasse og kontaktlærer</li>
            <li>Om du har lest og godtar ansvarsavtalen</li>
            <li>Om du er over 18 år, eller har fått foresattes tillatelse til å bruke utstyrsrommet</li>
        </ul>
    </blockquote>

    <blockquote>
        <hgroup>
            <h4>Hva skjer etterpå?</h4>
            <h5>Dataen som blir lagret er kun gyldig i 1 skoleår, og vil slettes før skolestart</h5>
        </hgroup>

        Du vil fremdeles være søkbar i utlånshistorikken, men kontoen din og all dataen som er knyttet til den vil
        bli slettet. Utlånshistorikken slettes ikke, men arkiveres for å kunne ivareta utstyrets historikk.
        <br>
        <br>
        <b>Obs for ansatte:</b> Ansatte ved skolen som har brukt utstyrsrommet vil ikke bli slettet automatisk, men kan
        slettes manuelt.
    </blockquote>

    <blockquote>
        <hgroup>
            <h4>Slett meg</h4>
            <h5>Ønsker du å slette din konto?</h5>
        </hgroup>
        Dersom du ønsker å slette din konto kan du gjøre det ved å trykke knappen under. Du kan når
        som helst logge inn igjen for å opprette kontoen på nytt.
        <br>
        <br>
        <button onclick="deleteMe()" class="red-button">Slett min brukerkonto</button>
    </blockquote>



    {% if session.user %}
        <script>
          function deleteMe() {
            $.confirm({
              title: 'Slett konto',
              icon: 'fa fa-trash',
              type: 'red',
              content: 'Er du sikker på at du vil slette kontoen din?<br>Du kan når som helst logge inn igjen for å opprette en ny konto.',
              buttons: {
                confirm: {
                  text: 'Slett',
                  btnClass: 'btn-red',
                  action: function () {
                    $.ajax({
                      type: 'POST',
                      url: '{{ url_for("api.delete_me") }}',
                      success: function (response) {
                        alertDeleted();
                      }
                    })
                  }
                },
                cancel: {
                  text: 'Avbryt',
                  btnClass: 'btn-blue',
                  action: function () {
                  }
                }
              }
            });
          }

          function alertDeleted() {
            $.confirm({
                title: 'Konto slettet',
                icon: 'fa fa-check-circle',
                type: 'green',
                content: 'Din konto er blitt slettet',
                buttons: {
                  cancel: {
                    text: 'Ok',
                    btnClass: 'btn-blue',
                    action: function () {
                      window.location.href = '{{ url_for("app.index") }}';
                    }
                  }
                },
                backgroundDismiss: function () {
                  window.location.href = '{{ url_for("app.index") }}';
                }
              }
            )
          }
        </script>
    {% else %}
        <script>
          function deleteMe() {
            $.alert({
              title: 'Slett konto',
              icon: 'fa fa-times-circle',
              type: 'orange',
              content: 'Du må være logget inn for å kunne slette kontoen din.',
              buttons: {
                login: {
                  text: 'Logg inn',
                  btnClass: 'btn-blue',
                  action: function () {
                    window.location.href = '{{ url_for("app.index") }}';
                  }
                },
                cancel: {
                  text: 'Avbryt',
                  btnClass: 'btn-red',
                  action: function () {
                  }
                }
              }
            });
          }
        </script>
    {% endif %}
{% endblock %}

